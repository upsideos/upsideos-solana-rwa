/**
 * This code was AUTOGENERATED using the Codama library.
 * Please DO NOT EDIT THIS FILE, instead use visitors
 * to add features, then rerun Codama to update it.
 *
 * @see https://github.com/codama-idl/codama
 */

import {
  combineCodec,
  fixDecoderSize,
  fixEncoderSize,
  getAddressEncoder,
  getArrayDecoder,
  getArrayEncoder,
  getBytesDecoder,
  getBytesEncoder,
  getProgramDerivedAddress,
  getStructDecoder,
  getStructEncoder,
  getU64Decoder,
  getU64Encoder,
  getU8Decoder,
  getU8Encoder,
  transformEncoder,
  type AccountMeta,
  type AccountSignerMeta,
  type Address,
  type Codec,
  type Decoder,
  type Encoder,
  type Instruction,
  type InstructionWithAccounts,
  type InstructionWithData,
  type ReadonlyAccount,
  type ReadonlySignerAccount,
  type ReadonlyUint8Array,
  type TransactionSigner,
  type WritableAccount,
  type WritableSignerAccount,
} from '@solana/kit';
import { DIVIDENDS_PROGRAM_ADDRESS } from '../programs';
import {
  expectAddress,
  expectSome,
  getAccountMetaFactory,
  type ResolvedAccount,
} from '../shared';

export const RECLAIM_DIVIDENDS_DISCRIMINATOR = new Uint8Array([
  32, 208, 208, 161, 89, 49, 92, 72,
]);

export function getReclaimDividendsDiscriminatorBytes() {
  return fixEncoderSize(getBytesEncoder(), 8).encode(
    RECLAIM_DIVIDENDS_DISCRIMINATOR
  );
}

export type ReclaimDividendsInstruction<
  TProgram extends string = typeof DIVIDENDS_PROGRAM_ADDRESS,
  TAccountDistributor extends string | AccountMeta<string> = string,
  TAccountReclaimer extends string | AccountMeta<string> = string,
  TAccountClaimStatus extends string | AccountMeta<string> = string,
  TAccountFrom extends string | AccountMeta<string> = string,
  TAccountTo extends string | AccountMeta<string> = string,
  TAccountTarget extends string | AccountMeta<string> = string,
  TAccountPayer extends string | AccountMeta<string> = string,
  TAccountMint extends string | AccountMeta<string> = string,
  TAccountAuthorityWalletRole extends string | AccountMeta<string> = string,
  TAccountAccessControl extends string | AccountMeta<string> = string,
  TAccountAuthority extends string | AccountMeta<string> = string,
  TAccountSystemProgram extends string | AccountMeta<string> =
    '11111111111111111111111111111111',
  TAccountTokenProgram extends string | AccountMeta<string> =
    'TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA',
  TRemainingAccounts extends readonly AccountMeta<string>[] = [],
> = Instruction<TProgram> &
  InstructionWithData<ReadonlyUint8Array> &
  InstructionWithAccounts<
    [
      TAccountDistributor extends string
        ? WritableAccount<TAccountDistributor>
        : TAccountDistributor,
      TAccountReclaimer extends string
        ? ReadonlyAccount<TAccountReclaimer>
        : TAccountReclaimer,
      TAccountClaimStatus extends string
        ? WritableAccount<TAccountClaimStatus>
        : TAccountClaimStatus,
      TAccountFrom extends string
        ? WritableAccount<TAccountFrom>
        : TAccountFrom,
      TAccountTo extends string ? WritableAccount<TAccountTo> : TAccountTo,
      TAccountTarget extends string
        ? ReadonlyAccount<TAccountTarget>
        : TAccountTarget,
      TAccountPayer extends string
        ? WritableSignerAccount<TAccountPayer> &
            AccountSignerMeta<TAccountPayer>
        : TAccountPayer,
      TAccountMint extends string
        ? ReadonlyAccount<TAccountMint>
        : TAccountMint,
      TAccountAuthorityWalletRole extends string
        ? ReadonlyAccount<TAccountAuthorityWalletRole>
        : TAccountAuthorityWalletRole,
      TAccountAccessControl extends string
        ? ReadonlyAccount<TAccountAccessControl>
        : TAccountAccessControl,
      TAccountAuthority extends string
        ? ReadonlySignerAccount<TAccountAuthority> &
            AccountSignerMeta<TAccountAuthority>
        : TAccountAuthority,
      TAccountSystemProgram extends string
        ? ReadonlyAccount<TAccountSystemProgram>
        : TAccountSystemProgram,
      TAccountTokenProgram extends string
        ? ReadonlyAccount<TAccountTokenProgram>
        : TAccountTokenProgram,
      ...TRemainingAccounts,
    ]
  >;

export type ReclaimDividendsInstructionData = {
  discriminator: ReadonlyUint8Array;
  bump: number;
  index: bigint;
  amount: bigint;
  proof: Array<ReadonlyUint8Array>;
};

export type ReclaimDividendsInstructionDataArgs = {
  bump: number;
  index: number | bigint;
  amount: number | bigint;
  proof: Array<ReadonlyUint8Array>;
};

export function getReclaimDividendsInstructionDataEncoder(): Encoder<ReclaimDividendsInstructionDataArgs> {
  return transformEncoder(
    getStructEncoder([
      ['discriminator', fixEncoderSize(getBytesEncoder(), 8)],
      ['bump', getU8Encoder()],
      ['index', getU64Encoder()],
      ['amount', getU64Encoder()],
      ['proof', getArrayEncoder(fixEncoderSize(getBytesEncoder(), 32))],
    ]),
    (value) => ({ ...value, discriminator: RECLAIM_DIVIDENDS_DISCRIMINATOR })
  );
}

export function getReclaimDividendsInstructionDataDecoder(): Decoder<ReclaimDividendsInstructionData> {
  return getStructDecoder([
    ['discriminator', fixDecoderSize(getBytesDecoder(), 8)],
    ['bump', getU8Decoder()],
    ['index', getU64Decoder()],
    ['amount', getU64Decoder()],
    ['proof', getArrayDecoder(fixDecoderSize(getBytesDecoder(), 32))],
  ]);
}

export function getReclaimDividendsInstructionDataCodec(): Codec<
  ReclaimDividendsInstructionDataArgs,
  ReclaimDividendsInstructionData
> {
  return combineCodec(
    getReclaimDividendsInstructionDataEncoder(),
    getReclaimDividendsInstructionDataDecoder()
  );
}

export type ReclaimDividendsAsyncInput<
  TAccountDistributor extends string = string,
  TAccountReclaimer extends string = string,
  TAccountClaimStatus extends string = string,
  TAccountFrom extends string = string,
  TAccountTo extends string = string,
  TAccountTarget extends string = string,
  TAccountPayer extends string = string,
  TAccountMint extends string = string,
  TAccountAuthorityWalletRole extends string = string,
  TAccountAccessControl extends string = string,
  TAccountAuthority extends string = string,
  TAccountSystemProgram extends string = string,
  TAccountTokenProgram extends string = string,
> = {
  /** The [MerkleDistributor]. */
  distributor: Address<TAccountDistributor>;
  /** Reclaimer account storing the wallet address. */
  reclaimer?: Address<TAccountReclaimer>;
  /** Status of the claim. */
  claimStatus?: Address<TAccountClaimStatus>;
  /** Distributor ATA containing the tokens to distribute. */
  from: Address<TAccountFrom>;
  /** Account to send the claimed tokens to. */
  to: Address<TAccountTo>;
  target: Address<TAccountTarget>;
  /** Payer of the claim. */
  payer: TransactionSigner<TAccountPayer>;
  mint: Address<TAccountMint>;
  /** Authority wallet role to pause the distributor. */
  authorityWalletRole: Address<TAccountAuthorityWalletRole>;
  /** Access Control for Security Token. */
  accessControl: Address<TAccountAccessControl>;
  /** Authority of the reclaim. */
  authority: TransactionSigner<TAccountAuthority>;
  /** The [System] program. */
  systemProgram?: Address<TAccountSystemProgram>;
  /** SPL [Token] program. */
  tokenProgram?: Address<TAccountTokenProgram>;
  bump: ReclaimDividendsInstructionDataArgs['bump'];
  index: ReclaimDividendsInstructionDataArgs['index'];
  amount: ReclaimDividendsInstructionDataArgs['amount'];
  proof: ReclaimDividendsInstructionDataArgs['proof'];
};

export async function getReclaimDividendsInstructionAsync<
  TAccountDistributor extends string,
  TAccountReclaimer extends string,
  TAccountClaimStatus extends string,
  TAccountFrom extends string,
  TAccountTo extends string,
  TAccountTarget extends string,
  TAccountPayer extends string,
  TAccountMint extends string,
  TAccountAuthorityWalletRole extends string,
  TAccountAccessControl extends string,
  TAccountAuthority extends string,
  TAccountSystemProgram extends string,
  TAccountTokenProgram extends string,
  TProgramAddress extends Address = typeof DIVIDENDS_PROGRAM_ADDRESS,
>(
  input: ReclaimDividendsAsyncInput<
    TAccountDistributor,
    TAccountReclaimer,
    TAccountClaimStatus,
    TAccountFrom,
    TAccountTo,
    TAccountTarget,
    TAccountPayer,
    TAccountMint,
    TAccountAuthorityWalletRole,
    TAccountAccessControl,
    TAccountAuthority,
    TAccountSystemProgram,
    TAccountTokenProgram
  >,
  config?: { programAddress?: TProgramAddress }
): Promise<
  ReclaimDividendsInstruction<
    TProgramAddress,
    TAccountDistributor,
    TAccountReclaimer,
    TAccountClaimStatus,
    TAccountFrom,
    TAccountTo,
    TAccountTarget,
    TAccountPayer,
    TAccountMint,
    TAccountAuthorityWalletRole,
    TAccountAccessControl,
    TAccountAuthority,
    TAccountSystemProgram,
    TAccountTokenProgram
  >
> {
  // Program address.
  const programAddress = config?.programAddress ?? DIVIDENDS_PROGRAM_ADDRESS;

  // Original accounts.
  const originalAccounts = {
    distributor: { value: input.distributor ?? null, isWritable: true },
    reclaimer: { value: input.reclaimer ?? null, isWritable: false },
    claimStatus: { value: input.claimStatus ?? null, isWritable: true },
    from: { value: input.from ?? null, isWritable: true },
    to: { value: input.to ?? null, isWritable: true },
    target: { value: input.target ?? null, isWritable: false },
    payer: { value: input.payer ?? null, isWritable: true },
    mint: { value: input.mint ?? null, isWritable: false },
    authorityWalletRole: {
      value: input.authorityWalletRole ?? null,
      isWritable: false,
    },
    accessControl: { value: input.accessControl ?? null, isWritable: false },
    authority: { value: input.authority ?? null, isWritable: false },
    systemProgram: { value: input.systemProgram ?? null, isWritable: false },
    tokenProgram: { value: input.tokenProgram ?? null, isWritable: false },
  };
  const accounts = originalAccounts as Record<
    keyof typeof originalAccounts,
    ResolvedAccount
  >;

  // Original args.
  const args = { ...input };

  // Resolve default values.
  if (!accounts.reclaimer.value) {
    accounts.reclaimer.value = await getProgramDerivedAddress({
      programAddress,
      seeds: [
        getBytesEncoder().encode(
          new Uint8Array([114, 101, 99, 108, 97, 105, 109, 101, 114])
        ),
        getAddressEncoder().encode(expectAddress(accounts.accessControl.value)),
      ],
    });
  }
  if (!accounts.claimStatus.value) {
    accounts.claimStatus.value = await getProgramDerivedAddress({
      programAddress,
      seeds: [
        getBytesEncoder().encode(
          new Uint8Array([67, 108, 97, 105, 109, 83, 116, 97, 116, 117, 115])
        ),
        getU64Encoder().encode(expectSome(args.index)),
        getAddressEncoder().encode(expectAddress(accounts.distributor.value)),
      ],
    });
  }
  if (!accounts.systemProgram.value) {
    accounts.systemProgram.value =
      '11111111111111111111111111111111' as Address<'11111111111111111111111111111111'>;
  }
  if (!accounts.tokenProgram.value) {
    accounts.tokenProgram.value =
      'TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA' as Address<'TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA'>;
  }

  const getAccountMeta = getAccountMetaFactory(programAddress, 'programId');
  return Object.freeze({
    accounts: [
      getAccountMeta(accounts.distributor),
      getAccountMeta(accounts.reclaimer),
      getAccountMeta(accounts.claimStatus),
      getAccountMeta(accounts.from),
      getAccountMeta(accounts.to),
      getAccountMeta(accounts.target),
      getAccountMeta(accounts.payer),
      getAccountMeta(accounts.mint),
      getAccountMeta(accounts.authorityWalletRole),
      getAccountMeta(accounts.accessControl),
      getAccountMeta(accounts.authority),
      getAccountMeta(accounts.systemProgram),
      getAccountMeta(accounts.tokenProgram),
    ],
    data: getReclaimDividendsInstructionDataEncoder().encode(
      args as ReclaimDividendsInstructionDataArgs
    ),
    programAddress,
  } as ReclaimDividendsInstruction<
    TProgramAddress,
    TAccountDistributor,
    TAccountReclaimer,
    TAccountClaimStatus,
    TAccountFrom,
    TAccountTo,
    TAccountTarget,
    TAccountPayer,
    TAccountMint,
    TAccountAuthorityWalletRole,
    TAccountAccessControl,
    TAccountAuthority,
    TAccountSystemProgram,
    TAccountTokenProgram
  >);
}

export type ReclaimDividendsInput<
  TAccountDistributor extends string = string,
  TAccountReclaimer extends string = string,
  TAccountClaimStatus extends string = string,
  TAccountFrom extends string = string,
  TAccountTo extends string = string,
  TAccountTarget extends string = string,
  TAccountPayer extends string = string,
  TAccountMint extends string = string,
  TAccountAuthorityWalletRole extends string = string,
  TAccountAccessControl extends string = string,
  TAccountAuthority extends string = string,
  TAccountSystemProgram extends string = string,
  TAccountTokenProgram extends string = string,
> = {
  /** The [MerkleDistributor]. */
  distributor: Address<TAccountDistributor>;
  /** Reclaimer account storing the wallet address. */
  reclaimer: Address<TAccountReclaimer>;
  /** Status of the claim. */
  claimStatus: Address<TAccountClaimStatus>;
  /** Distributor ATA containing the tokens to distribute. */
  from: Address<TAccountFrom>;
  /** Account to send the claimed tokens to. */
  to: Address<TAccountTo>;
  target: Address<TAccountTarget>;
  /** Payer of the claim. */
  payer: TransactionSigner<TAccountPayer>;
  mint: Address<TAccountMint>;
  /** Authority wallet role to pause the distributor. */
  authorityWalletRole: Address<TAccountAuthorityWalletRole>;
  /** Access Control for Security Token. */
  accessControl: Address<TAccountAccessControl>;
  /** Authority of the reclaim. */
  authority: TransactionSigner<TAccountAuthority>;
  /** The [System] program. */
  systemProgram?: Address<TAccountSystemProgram>;
  /** SPL [Token] program. */
  tokenProgram?: Address<TAccountTokenProgram>;
  bump: ReclaimDividendsInstructionDataArgs['bump'];
  index: ReclaimDividendsInstructionDataArgs['index'];
  amount: ReclaimDividendsInstructionDataArgs['amount'];
  proof: ReclaimDividendsInstructionDataArgs['proof'];
};

export function getReclaimDividendsInstruction<
  TAccountDistributor extends string,
  TAccountReclaimer extends string,
  TAccountClaimStatus extends string,
  TAccountFrom extends string,
  TAccountTo extends string,
  TAccountTarget extends string,
  TAccountPayer extends string,
  TAccountMint extends string,
  TAccountAuthorityWalletRole extends string,
  TAccountAccessControl extends string,
  TAccountAuthority extends string,
  TAccountSystemProgram extends string,
  TAccountTokenProgram extends string,
  TProgramAddress extends Address = typeof DIVIDENDS_PROGRAM_ADDRESS,
>(
  input: ReclaimDividendsInput<
    TAccountDistributor,
    TAccountReclaimer,
    TAccountClaimStatus,
    TAccountFrom,
    TAccountTo,
    TAccountTarget,
    TAccountPayer,
    TAccountMint,
    TAccountAuthorityWalletRole,
    TAccountAccessControl,
    TAccountAuthority,
    TAccountSystemProgram,
    TAccountTokenProgram
  >,
  config?: { programAddress?: TProgramAddress }
): ReclaimDividendsInstruction<
  TProgramAddress,
  TAccountDistributor,
  TAccountReclaimer,
  TAccountClaimStatus,
  TAccountFrom,
  TAccountTo,
  TAccountTarget,
  TAccountPayer,
  TAccountMint,
  TAccountAuthorityWalletRole,
  TAccountAccessControl,
  TAccountAuthority,
  TAccountSystemProgram,
  TAccountTokenProgram
> {
  // Program address.
  const programAddress = config?.programAddress ?? DIVIDENDS_PROGRAM_ADDRESS;

  // Original accounts.
  const originalAccounts = {
    distributor: { value: input.distributor ?? null, isWritable: true },
    reclaimer: { value: input.reclaimer ?? null, isWritable: false },
    claimStatus: { value: input.claimStatus ?? null, isWritable: true },
    from: { value: input.from ?? null, isWritable: true },
    to: { value: input.to ?? null, isWritable: true },
    target: { value: input.target ?? null, isWritable: false },
    payer: { value: input.payer ?? null, isWritable: true },
    mint: { value: input.mint ?? null, isWritable: false },
    authorityWalletRole: {
      value: input.authorityWalletRole ?? null,
      isWritable: false,
    },
    accessControl: { value: input.accessControl ?? null, isWritable: false },
    authority: { value: input.authority ?? null, isWritable: false },
    systemProgram: { value: input.systemProgram ?? null, isWritable: false },
    tokenProgram: { value: input.tokenProgram ?? null, isWritable: false },
  };
  const accounts = originalAccounts as Record<
    keyof typeof originalAccounts,
    ResolvedAccount
  >;

  // Original args.
  const args = { ...input };

  // Resolve default values.
  if (!accounts.systemProgram.value) {
    accounts.systemProgram.value =
      '11111111111111111111111111111111' as Address<'11111111111111111111111111111111'>;
  }
  if (!accounts.tokenProgram.value) {
    accounts.tokenProgram.value =
      'TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA' as Address<'TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA'>;
  }

  const getAccountMeta = getAccountMetaFactory(programAddress, 'programId');
  return Object.freeze({
    accounts: [
      getAccountMeta(accounts.distributor),
      getAccountMeta(accounts.reclaimer),
      getAccountMeta(accounts.claimStatus),
      getAccountMeta(accounts.from),
      getAccountMeta(accounts.to),
      getAccountMeta(accounts.target),
      getAccountMeta(accounts.payer),
      getAccountMeta(accounts.mint),
      getAccountMeta(accounts.authorityWalletRole),
      getAccountMeta(accounts.accessControl),
      getAccountMeta(accounts.authority),
      getAccountMeta(accounts.systemProgram),
      getAccountMeta(accounts.tokenProgram),
    ],
    data: getReclaimDividendsInstructionDataEncoder().encode(
      args as ReclaimDividendsInstructionDataArgs
    ),
    programAddress,
  } as ReclaimDividendsInstruction<
    TProgramAddress,
    TAccountDistributor,
    TAccountReclaimer,
    TAccountClaimStatus,
    TAccountFrom,
    TAccountTo,
    TAccountTarget,
    TAccountPayer,
    TAccountMint,
    TAccountAuthorityWalletRole,
    TAccountAccessControl,
    TAccountAuthority,
    TAccountSystemProgram,
    TAccountTokenProgram
  >);
}

export type ParsedReclaimDividendsInstruction<
  TProgram extends string = typeof DIVIDENDS_PROGRAM_ADDRESS,
  TAccountMetas extends readonly AccountMeta[] = readonly AccountMeta[],
> = {
  programAddress: Address<TProgram>;
  accounts: {
    /** The [MerkleDistributor]. */
    distributor: TAccountMetas[0];
    /** Reclaimer account storing the wallet address. */
    reclaimer: TAccountMetas[1];
    /** Status of the claim. */
    claimStatus: TAccountMetas[2];
    /** Distributor ATA containing the tokens to distribute. */
    from: TAccountMetas[3];
    /** Account to send the claimed tokens to. */
    to: TAccountMetas[4];
    target: TAccountMetas[5];
    /** Payer of the claim. */
    payer: TAccountMetas[6];
    mint: TAccountMetas[7];
    /** Authority wallet role to pause the distributor. */
    authorityWalletRole: TAccountMetas[8];
    /** Access Control for Security Token. */
    accessControl: TAccountMetas[9];
    /** Authority of the reclaim. */
    authority: TAccountMetas[10];
    /** The [System] program. */
    systemProgram: TAccountMetas[11];
    /** SPL [Token] program. */
    tokenProgram: TAccountMetas[12];
  };
  data: ReclaimDividendsInstructionData;
};

export function parseReclaimDividendsInstruction<
  TProgram extends string,
  TAccountMetas extends readonly AccountMeta[],
>(
  instruction: Instruction<TProgram> &
    InstructionWithAccounts<TAccountMetas> &
    InstructionWithData<ReadonlyUint8Array>
): ParsedReclaimDividendsInstruction<TProgram, TAccountMetas> {
  if (instruction.accounts.length < 13) {
    // TODO: Coded error.
    throw new Error('Not enough accounts');
  }
  let accountIndex = 0;
  const getNextAccount = () => {
    const accountMeta = (instruction.accounts as TAccountMetas)[accountIndex]!;
    accountIndex += 1;
    return accountMeta;
  };
  return {
    programAddress: instruction.programAddress,
    accounts: {
      distributor: getNextAccount(),
      reclaimer: getNextAccount(),
      claimStatus: getNextAccount(),
      from: getNextAccount(),
      to: getNextAccount(),
      target: getNextAccount(),
      payer: getNextAccount(),
      mint: getNextAccount(),
      authorityWalletRole: getNextAccount(),
      accessControl: getNextAccount(),
      authority: getNextAccount(),
      systemProgram: getNextAccount(),
      tokenProgram: getNextAccount(),
    },
    data: getReclaimDividendsInstructionDataDecoder().decode(instruction.data),
  };
}
